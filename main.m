% GONZALO RUIZ GUERRERO % JAVIER SOTO GARCIA % Lectura de los datos %data = csvread('autos.csv');% - - - - - - - - APARTADO 1: ESTADISTICAS - - - - - - - %% (Devuelve Matriz) C谩lculo de media - desviaci贸n estandar - valor m谩ximo - valor m铆nimo %matrix = estadisticas(data);#matrix = [{'';'Media';'Std';'Min';'Max'} matrix]#matrix = [{'','Cilindros', 'Desplazamiento', 'Potencia', 'Peso', 'Aceleracin', 'Ao', 'Pais', 'MPG'},matrix];y = data(:,8);m = length(y);X = data(:,1:7);X = [ones(m, 1) X];% - - - - - - - - APARTADO 2: MODELO DE REGRESIN SEGUN LA ECUACIN NORMAL - - - - - - - %% Variable desplazamiento %X_displacement = data(:,2);X_displacement = [ones(m, 1) X_displacement];% Variable peso %X_weight = data(:,4);X_weight = [ones(m, 1) X_weight];% Variable aceleraci贸n %X_acceleration = data(:,5);X_acceleration = [ones(m, 1) X_acceleration];% Variable Y - Millas por gal贸n %% Ecuaci贸n normal con las variables desplazamiento peso y aceleraci贸n  %theta_displacement = normalEqn(X_displacement,y);theta_weight = normalEqn(X_weight,y);theta_acceleration = normalEqn(X_acceleration, y);disp('Valor de theta para el desplazamiento');disp(theta_displacement);disp('Valor de theta para el peso');disp(theta_weight);disp('Valor de theta para la aceleraci贸n');disp(theta_acceleration);% Ecuaci贸n normal con todas las variables%theta = normalEqn(X,y);theta2 = theta;disp('Theta regresion multivariable');disp(theta);percent = 0.70;[X_train y_train X_test y_test] = holdout(X,y,m,percent);theta = normalEqn(X_train,y_train);pre = X_test * theta;error = (1/length(X_test)) * sum(abs(pre-y_test));disp('Error medio absoluto:');disp(error);% - - - - - - - - - APARTADO 3: VISUALIZAR DATOS - - - - - - - - %#AL FINAL DEL FICHERO#% - - - - - - - - - APARTADO 4: DESCENSO DEL GRADIENTE - - - - - - - %% ERROR ECUACIN NORMAL %% Con atributo 2 %#Displacement (atributo 2)X_train_displacement = [ones(size(X_train(:,3)), 1) X_train(:,3)];X_test_displacement = [ones(size(X_test(:,3)), 1) X_test(:,3)];theta_dg_displacement = normalEqn(X_train_displacement,y_train);pre = X_test_displacement * theta_dg_displacement;errorDisplacement = (1/length(theta_dg_displacement)) * sum(abs(pre-y_test));#Weight (atributo 4)X_train_weight = [ones(size(X_train(:,5)), 1) X_train(:,5)];X_test_weight = [ones(size(X_test(:,5)), 1) X_test(:,5)];theta_dg_weight = normalEqn(X_train_weight,y_train);pre = X_test_weight * theta_dg_weight;errorWeight = (1/length(theta_dg_weight)) * sum(abs(pre-y_test));#Acceleration (atributo 5)X_train_acceleration = [ones(size(X_train(:,6)), 1) X_train(:,6)];X_test_acceleration = [ones(size(X_test(:,6)), 1) X_test(:,6)];theta_dg_acceleration = normalEqn(X_train_acceleration,y_train);pre = X_test_acceleration * theta_dg_acceleration;errorAcceleration = (1/length(theta_dg_acceleration)) * sum(abs(pre-y_test));#Error Gradiente Totalalpha = 0.000000000003;iterations = 400000;theta = zeros(8,1);[theta J_history_Total] = gradientDescent(X_train, y_train, theta, alpha, iterations);disp("THETA ");disp(min(theta));disp("TOTAL JHist ");length_Total = length(J_history_Total)disp(J_history_Total(length_Total));#Error Gradiente Displacementalpha = 0.000000001;iterations = 200000;theta_gd_displacement = [0;0];[theta_gd_displacement J_history] = gradientDescent(X_train_displacement, y_train, theta_gd_displacement, alpha, iterations);disp("THETA displacement ");disp(min(theta_gd_displacement));disp("displacement JHist ");length_displacement = length(J_history)disp(J_history(length_displacement));#Error Gradiente Weightalpha = 0.000000000001;iterations = 300000;theta_gd_weight =[0;0];[theta_gd_weight J_history] = gradientDescent(X_train_weight, y_train, theta_gd_weight, alpha, iterations);disp("THETA weight ");disp(min(theta_gd_weight));disp("weight JHist ");length_weight = length(J_history)disp(J_history(length_weight));#Error Gradiente Accelerationalpha = 0.00000003;iterations = 300000;theta_gd_acceleration =[0;0];[theta_gd_acceleration J_history] = gradientDescent(X_train_acceleration, y_train, theta_gd_acceleration, alpha, iterations);disp("THETA acceleration ");disp(min(theta_gd_acceleration));disp("acceleration JHist ");length_acceleration = length(J_history)disp(J_history(length_acceleration));% - - - - - - - - - APARTADO 3: VISUALIZAR DATOS - - - - - - - - %visualizarDatos(data,X,y,X_train,y_train,theta_displacement,theta_weight,theta_acceleration,theta,theta2,J_history_Total)        